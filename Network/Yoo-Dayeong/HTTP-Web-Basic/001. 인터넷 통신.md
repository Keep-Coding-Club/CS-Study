# 001. 인터넷 통신

# 인터넷에서 컴퓨터 둘은 어떻게 통신할까?

- 보내는 사람과 받는 사람은 복잡한 중간과정을 거쳐서 통신한다.

## IP(Internet protocol)

- 역할
  인터넷 프로토콜
- 기능
  지정한 IP주소에 데이터 전달할 수 있도록 함.
- 통신 단위
  패킷(Packet)

### IP 패킷 정보

- 출발지 IP
- 목적지 IP
- 메시지

### IP 프로토콜의 한계

- **비연결성**
  - 패킷을 받을 대상 X
  - 서비스 불능 상태임에도 패킷 전송
    e.g. 마치 편지를 보내지만 받는 사람이 이사했을 수도 있음.
- **비신뢰성**
  - 중간에 패킷이 사라지면?(패킷 소실)
  - 패킷이 순서대로 안오면?(패킷 전달 순서 문제발생)
    - 패킷을 1500bytes씩 끊어서 보낸다.
    - 이때 패킷은 중간 노드들을 타서 이동되는데, 이때 순서가 뒤바뀔 수 있음
- 프로그램 구분
  - 같은 IP를 사용하는 서버에서 통신하는 어플리케이션이 둘 이상이라면?

# TCP

→ IP 프로토콜의 비연결성, 비신뢰성 과 같은 문제로 나온 해결방안

## 인터넷 프로토콜 스택의 4계층

| 애플리케이션 계층        | HTTP/ FTP |
| ------------------------ | --------- |
| 전송 계층                | TCP/ UDP  |
| 인터넷 계층              | IP        |
| 네트워크 인터페이스 계층 |           |

실제 예시를 통해 알아보자.

| 애플리케이션 계층 | 1. 프로그램이 Hello, world! 메시지 생성 2. SOCKET 라이브러리를 통해 전달(HTTP) |
| --- | --- |
| 전송 계층 | 3. TCP 정보 생성, 메시지 데이터 포함 |
| 인터넷 계층 | 4. IP 패킷 생성, TCP 데이터 포함 |
| 네트워크 인터페이스 계층 | 5. LAN 카드(Ethernet frame) |

## TCP 특징

전송 제어 프로토콜(Transmission Control Protocol)

- 연결 지향
  - 3 way handshake
- 데이터 전달 보증
- 순서 보장
- 신뢰할 수 있는 프로토콜
- 대부분의 어플리케이션은 TCP 사용

### 연결 지향 - TCP 3 way handshake

이때 TCP 3 way handshake는 나를 위한 전용 LAN선 제공 아님에 주의

- 즉, 논리적으로 “자 우리 연결됐지?”라고 생각하는 것!

### 데이터 전달 보증

클라이언트가 1. 데이터를 전송하면 서버는 2. 데이터를 잘 받았다는 응답을 준다

### 순서 보장

1. 클라이언트에서 패킷(1, 2, 3) 순서로 보낸다
2. 서버에게 패킷(1, 3, 2)순서로 도착한다
3. 서버는 순서가 바뀐 시점인 `패킷 2부터 다시 보내`라는 응답을 준다

_어떻게 서버가 순서를 알고 있지?_

### TCP/IP 패킷 정보

TCP 세그먼트 안에 `전송제어`, `순서`, `검증 정보`가 포함되어 있기 때문에 가능!

따라서 TCP를 신뢰할 수 있는 프로토콜이라고 한다.

## UDP 특징

사용자 데이터그램 프로토콜(User Datagram Protocol)

- 하얀 도화지에 비유(기능이 거의 없음)
- 연결 지향 X
- 데이터 전달 보증 X
- 순서 보장 X
- 데이터 전달 및 순서가 보장되지 않지만, 단순하고 빠르다.

정리

- IP와 거의 비슷(+ PORT, 체크섬 정도만 추가된 것)
  PORT: 하나의 IP에서 여러 어플리케이션 작동할 때 구분해주기 위한 통로
  체크섬: 메시지가 맞는지 검증하기 위한 용도
- 어플리케이션에서 추가 작업 필요함.
- TCP은 이미 구축되어 있는 프로토콜임. 최적화를 하기 위해서는 UDP를 조절해주어야 함.
- 최근에는 UDP가 뜨고 있음.
  - HTTP3 같은 경우 UDP 프로토콜을 사용함.

# PORT

## 한번에 둘 이상 연결해야 하면?

클라이언트는 게임 + 화상통화 + 웹 브라우저 요청이라는 동시작업 중.

이때 서버에게 관련 작업의 패킷을 요청하고 받을 때 각각 어떤 작업의 패킷인지 구분할 필요성.

`하나의 IP로는 구분을 못하네..`

따라서 나온게 **PORT**임.

IP: 목적지 서버를 찾는 것

PORT: 서버 안에서 돌아가는 어플리케이션 구분

![스크린샷 2023-07-21 오후 3.45.54.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/97813be1-d7f8-4a95-b8b5-19415a3f8d89/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-21_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.45.54.png)

- 지금부터는 위와 같이 TCP/IP 패킷을 합쳐서 말하겠음

즉, PORT는 같은 IP 내에서 프로세스를 구분한다.

~비유~

IP: 아파트

PORT: n동 n호

# DNS

- IP는 기억하기 어렵다.
- IP는 변경될 수 있다.

위와 같은 문제점으로 해결법인 DNS 나옴

클라이언트가 도메인 명으로 요청하면 DNS 서버는 IP 주소를 응답해준다.

따라서 클라이언트는 응답받은 IP주소를 바탕으로 해당 서비스의 서버에게 요청!
