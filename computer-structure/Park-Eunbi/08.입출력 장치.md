# 08-1. 장치 컨트롤러와 장치 드라이버 
## 장치 컨트롤러 
입출력 장치는 
1. 너무 다양하다 
2. cpu에 비해 속도가 매우 느리다 
이러한 이유로 입출력 장치는 컴퓨터에 직접 연결되지 않고 장치 컨트롤러라는 하드웨어를 통해 연결된다 
장치 컨트롤러는 입출력 제어기, 입출력 모듈 등으로 다양하게 불린다 

위의 문제 해결 방법 
- cpu 와 입출력장치 간의 통신 중계
- 오류 검출 
- 데이터 버퍼링 
	: 전송률이 높은 장치와 낮은 장치 사이에 주고받는 데이터를 버퍼라는 임시 공간에 저장하여 전송률을 비슷하게 맞추는 방법 

### 장치 컨트롤러의 내부 구조 
데이터 레지스터
- cpu와 입출력 장치 사이에 주고 받을 데이터가 담기는 레지스터 
- 버퍼역할을 함 
- 주고 받는 데이터가 많은 입출력 장치에서는 레지스터 대신 RAM을 사용
상태 레지스터 
- 입출력 작업을 할 준비가 되었는지, 작업이 완료되었는지, 오류가 없는지 등의 상태 정보를 저장
제어 레지스터
- 입출력 장치가 수행할 내용에 대한 정보와 명령 저장 

이 레지스터 들에 담긴 값들은 버스를 타고 cpu나 다른 입출력 장치로 전달

## 장치 드라이버 
장치 컨트롤러의 동작을 감지하고 제어함으로써 장치 컨트롤러가 컴퓨터 내부와 정보를 주고받을 수 있게 하는 프로그램 
장치 컨트롤러: 하드웨어적인 통로
장치 드라이버: 소프트에어적인 통로 

# 08-2. 다양한 입출력 방법
## 프로그램 입출력 
프로그램 속 명령어로 입출력 장치를 제어하는 방법 
cpu가 프로그램 속 명령어를 실행하는 과정에서 입출력 명령어를 만나면 cpu는 입출력 장치에 연결된 장치 컨트롤러와 상호작용하며 입출력 작업 수행 
### 메모리에 저장된 정보를 하드 디스크에 백업하는 예시 
1. cpu는 하드디스크 컨트롤러의 제어 레지스터에 쓰기 명령 보냄
2. 하드 디스크 컨트롤러가 하드 디스크의 상태 확인, 준비 되었다면 상태 레지스터에 준비 되었다고 표시 
3. cpu는 상태 레지스터를 주기적으로 읽어보며 하드 디스크의 준비 여부 확인. 준비 되었다면 백업할 메모리의 정보를 데이터 레지스터에 씀, 쓰기가 끝나면 작업 종료 (끝나지 않았다면 1번 부터 반복)

## 메모리 맵 입출력 
메모리에 접근하기 위한 주소 공간과 입출력 장치에 접근하기 위한 주소 공간을 하나의 주소 공간으로 간주하는 방법 
## 고립형 입출력 
메모리를 위한 주소 공간과 입출력장치를 위한 주소 공간을 분리하는 방법 
## 인터럽트 기반 입출력 
장치 컨트롤러가 입출력 작업을 끝낸 뒤 cpu에게 인터럽트 요청 신호를 보내면 cpu는 하던 일을 잠시 백업하고 인터럽트 서비스 루틴 실행 
-> 인터럽트를 기반으로 하는 입출력을 인터럽트 기반 입출력이라 함 
cf) 풀링: 입출력 상태, 처리할 데이터를 주기적으로 확인하는 방법 (cpu에 부담이 큼)

## 여러 입출력 장치에서 인터럽트가 동시에 발생하는 경우 
- 인터럽트가 발생한 순서대로 처리하는 방법 
- 우선순위가 높은 인터럽트 순으로 처리하는 방법 
	프로그래머블 인터럽트 컨트롤러 (PIC) - 인터럽트 요청들의 우선순위를 판별한 뒤 cpu에 처리해야 할 하드웨어 인터럽트가 무엇인지 알려주는 장치 
#### PIC의 다중 인터럽트 처리 과정 
1. 장치 컨트롤러에서 인터럽트 요청 신호들을 받아들임
2. 인터럽트 우선순위를 판단한 뒤 cpu에 처리해야 할 인터럽트 요청 신호를 보냄 
3. cpu는 pic에 인터럽트 확인 신호를 보냄 
4. 데이터 버스를 통해 cpu에 인터럽트 벡터를 보냄 
5. 인터럽트 벡터를 통해 요청의 주체를 알게 되고, 해당 장치의 인터럽트 서비스 루틴 실행 

## DMA 입출력 
입출력 장치와 메모리가 cpu를 거치지 않고 상호작용할 수 있는 방법 
직접 메모리에 접근할 수 있는 입출력 기능 
DMA 컨트롤러라는 하드웨어 필요 
### DMA 입출력 과정 
1. cpu는 dma 컨트롤러에 입출력장치의 주소, 수행할 연산, 메모리의 주소 등과 같ㅇ느 정보로 입출력 작업 명령 
2. dma 컨트롤러는 cpu 장치 컨트롤러와 상호작용하며 입출력 작업 수행, 필요시 dma 컨트롤러는 메모리에 직접 접근하여 정보를 읽고 씀
3. 입출력 작업이 끝나면 dma 컨트롤러는 cpu에 인터럽트를 걸어 작업이 끝났음을 알림

### 입출력 버스 
cpu, 메모리, dma 컨트롤러, 장치 컨트롤러가 모두 같은 버스를 공유하는 구성에서는 dma를 위해 메모리에 접근할 때마다 시스템 버스를 두 번 사용하는 부작용 발생 
이 문제는 dma 컨트롤러와 장치 컨트롤러들을 입출력 버스라는 별도에 버스로 연결하여 해결 
